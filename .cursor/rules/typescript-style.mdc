---
globs: *.ts,*.tsx,*.mts,*.cts
---

# TypeScript Style Guide

Follow these conventions across TypeScript sources to align with the existing
configuration and code style.

## Language and Types

- Use strict typing (see [tsconfig.json](mdc:tsconfig.json)).
- Prefer explicit function signatures for exported APIs.
- Avoid `any`; model complex shapes with `zod` schemas where relevant.
- Use meaningful, descriptive names. Avoid 1–2 character identifiers.
- Prefer early returns and shallow control flow.

## Modules and Imports

- ESM modules by default (see `module` in [tsconfig.json](mdc:tsconfig.json)).
- Keep public exports centralized in [src/index.ts](mdc:src/index.ts).

## Errors and Handling

- Do not swallow errors. Propagate or wrap with context using Vercel AI SDK
  standard errors (`APICallError`, `LoadAPIKeyError`, `NoSuchModelError` from
  `@ai-sdk/provider`).
- Only use `try/catch` where meaningful recovery or re-throw with context is
  performed.

## Formatting and Linting

- Respect [eslint.config.mjs](mdc:eslint.config.mjs) and Prettier (see
  `prettier-*` scripts in [package.json](mdc:package.json)).
- Keep lines readable; prefer multi-line over dense one-liners.
- Avoid inline explanatory comments; add brief comments above non-obvious logic.

## Provider-specific Conventions

- The provider function must not be invoked with `new` (explicitly guarded in
  [src/sap-ai-provider.ts](mdc:src/sap-ai-provider.ts)).
- The internal implementation uses V3 types (`LanguageModelV3`, `EmbeddingModelV3`)
  while the public API exposes V2 types via adapters.
- When adding model capabilities, ensure `SAPAILanguageModel` maintains the
  internal `LanguageModelV3` contract (see
  [src/sap-ai-language-model.ts](mdc:src/sap-ai-language-model.ts)).
- When modifying V2 facade files, ensure V3→V2 adapters transform types correctly
  (see [src/sap-ai-adapters-v3-to-v2.ts](mdc:src/sap-ai-adapters-v3-to-v2.ts)).
